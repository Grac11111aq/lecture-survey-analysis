# 小学校出前授業アンケート 定量的解析計画書

## 1. 解析の全体像と目的

### 1.1 主要な研究課題
1. **教育効果の定量的評価**: 出前授業は児童の「ものの溶け方」理解を有意に向上させたか？
2. **実験の影響評価**: 炎色反応・再結晶実験は児童の興味・理解にどう影響したか？
3. **個人差・クラス差の要因**: どのような要因が理解度の差を生むか？
4. **感想の定量化**: テキストデータから教育効果の質的側面を定量的に評価

## 2. 段階的解析プラン

### Phase 1: データ品質確認と基礎統計（1-2日目）

#### 1.1 データ品質チェック
```python
# 実施項目
- 欠損値パターンの確認（MCAR/MAR/MNAR判定）
- 回答の一貫性チェック（論理的矛盾の検出）
- 外れ値・異常値の検出
- Page_IDの重複確認（前後アンケートのマッチング）
```

#### 1.2 記述統計量の算出
```python
# 各変数の基本統計量
- 度数分布表（クラス別、全体）
- 中心傾向（平均、中央値、最頻値）
- ばらつき（標準偏差、四分位範囲）
- 歪度・尖度（正規性の確認）
```

**判断基準**: 
- 欠損率>20%の項目は解析から除外を検討
- 極端な偏りがある項目は変数変換を検討

### Phase 2: 教育効果の統計的検証（3-4日目）

#### 2.1 授業前後の変化（主要解析）
```python
# Q1: 水溶液認識の変化
- 各項目の正答率変化（McNemar検定）
- 総合スコアの変化（対応のあるt検定）
- 効果量の算出（Cohen's d）
- 95%信頼区間の算出

# Q3: お茶の理解度変化
- 2項目それぞれのMcNemar検定
- 組み合わせパターンの変化分析
```

**検定の多重性補正**: Bonferroni法またはFDR法を適用

#### 2.2 サンプルサイズと検出力
```python
# 事後的検出力分析
- N=99での検出可能な効果量
- 必要サンプルサイズの算出（将来の研究のため）
```

**判断基準**:
- p < 0.05を有意水準とする
- 効果量 d > 0.2を実質的に意味のある変化とする
- 検出力 > 0.8を確保

### Phase 3: 集団間差異の分析（5-6日目）

#### 3.1 クラス間比較
```python
# 一元配置分散分析（ANOVA）
- 授業前スコアのクラス間差異
- 授業後スコアのクラス間差異
- 変化量のクラス間差異
- 事後検定（Tukey HSD）
```

#### 3.2 理解度の要因分析
```python
# 重回帰分析 / ロジスティック回帰
従属変数: Q6（理解度4段階）
独立変数:
- Q4（実験への興味）
- 授業前の理解度（Q1, Q3スコア）
- クラス（ダミー変数）
- テキスト特徴量（後述）
```

**判断基準**:
- VIF < 10（多重共線性のチェック）
- R² > 0.3を説明力ありとする

### Phase 4: テキストマイニング（7-9日目）

#### 4.1 前処理と基礎分析
```python
# 対象テキスト
- Q2: みそ汁の理由（前後）
- Q5: 新しい学び（後のみ）
- 感想文

# 前処理
- 形態素解析（MeCab + NEologd辞書）
- 不要語除去（ストップワード）
- 表記ゆれ統一
```

#### 4.2 定量的テキスト分析
```python
# 頻度分析
- 単語頻度（TF）
- TF-IDF による重要語抽出
- n-gram分析（2-gram, 3-gram）

# 共起分析
- 共起ネットワーク作成
- 中心性指標の算出
- クラスター分析

# 感情分析
- ポジティブ/ネガティブ分類
- 感情スコアと理解度の相関
```

#### 4.3 トピックモデリング
```python
# LDA（Latent Dirichlet Allocation）
- 最適トピック数の決定（Perplexity, Coherence）
- トピック別の文書分類
- トピックと理解度の関連分析
```

**判断基準**:
- 頻出上位20語で内容を代表できるか
- トピックの解釈可能性

### Phase 5: 統合的分析と予測モデル（10-11日目）

#### 5.1 構造方程式モデリング（SEM）
```python
# 潜在変数
- 「科学的理解」（Q1, Q3から構成）
- 「学習への積極性」（Q4, テキスト感情から構成）

# パス解析
- 授業前理解 → 実験への興味 → 授業後理解
- 媒介効果の検証
```

#### 5.2 機械学習による理解度予測
```python
# 分類モデル（理解度4段階）
- ランダムフォレスト
- XGBoost
- 交差検証（5-fold）
- 特徴量重要度の算出
```

**判断基準**:
- CFI > 0.95, RMSEA < 0.06（SEM適合度）
- 予測精度 > 70%

### Phase 6: 結果の統合と提言（12-14日目）

#### 6.1 効果量のメタ分析的統合
```python
# Forest plotの作成
- 各項目の効果量と信頼区間
- 全体効果の推定
```

#### 6.2 実践的提言の作成
- 最も効果的だった要素の特定
- 改善が必要な領域の特定
- 次回授業への具体的提案

## 3. 品質保証とバリデーション

### 3.1 統計的前提条件の確認
- 正規性検定（Shapiro-Wilk test）
- 等分散性検定（Levene's test）
- 独立性の確認

### 3.2 ロバスト性チェック
- ノンパラメトリック手法での再検証
- ブートストラップ法による信頼区間
- 外れ値除外時の感度分析

### 3.3 再現性の確保
- ランダムシードの固定
- 解析コードの文書化
- データ処理履歴の記録

## 4. 期待される成果と判断基準

### 4.1 主要な仮説と期待される結果
1. **仮説1**: 授業後の水溶液理解度は有意に向上する（効果量 d > 0.5）
2. **仮説2**: 実験への興味が高い児童ほど理解度も高い（r > 0.3）
3. **仮説3**: 感想文のポジティブ度と理解度は正の相関（r > 0.2）

### 4.2 解析続行/中止の判断基準
- **続行**: Phase 2で有意な教育効果が確認された場合
- **修正**: 効果が小さい場合は、サブグループ分析を強化
- **追加**: 予期しないパターンが発見された場合は探索的分析を追加

### 4.3 次ステップへの移行基準
各Phaseの完了条件:
- すべての計画された検定の実施
- 結果の妥当性確認
- 可視化の作成
- 中間レポートの作成

## 5. リスク管理

### 5.1 想定されるリスクと対策
- **欠損値が多い**: 多重代入法の適用
- **サンプルサイズ不足**: ベイズ統計の適用
- **テキストデータの質**: 手動コーディングでの補完

### 5.2 倫理的配慮
- 個人の特定につながる分析は行わない
- ネガティブな結果も公正に報告
- 教育的示唆は慎重に行う

## 6. タイムライン

| Phase | 内容 | 所要時間 | 成果物 |
|-------|------|----------|---------|
| 1 | データ品質確認 | 1-2日 | 品質レポート |
| 2 | 教育効果検証 | 2日 | 統計検定結果 |
| 3 | 集団間分析 | 2日 | 要因分析結果 |
| 4 | テキスト分析 | 3日 | 頻出語、トピック |
| 5 | 統合分析 | 2日 | 予測モデル |
| 6 | 最終まとめ | 2-3日 | 最終レポート |

**総所要時間**: 12-14日（実働）

## 7. 必要なツール・ライブラリ

### Python パッケージ
```python
# 統計解析
- scipy.stats（検定）
- statsmodels（回帰分析）
- pingouin（効果量）
- scikit-learn（機械学習）

# テキスト分析
- mecab-python3（形態素解析）
- gensim（トピックモデリング）
- networkx（ネットワーク分析）
- wordcloud（可視化）

# 可視化
- matplotlib / seaborn（静的）
- plotly（インタラクティブ）
- graphviz（構造図）
```

## 8. 確認事項

この計画で進めてよろしいでしょうか？
特に以下の点についてご確認ください：

1. **統計的有意水準**: α = 0.05 でよいか
2. **効果量の基準**: Cohen's d > 0.2 を実質的効果とするか
3. **テキスト分析の深さ**: トピックモデリングまで必要か
4. **予測モデル**: 機械学習まで実施するか
5. **レポート形式**: 学術論文形式か、実践的提言重視か

ご指示いただければ、優先順位の調整や特定の分析の追加・削除を行います。