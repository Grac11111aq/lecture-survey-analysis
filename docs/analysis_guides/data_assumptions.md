# 🚨 重要: データ構造と分析前提条件

## データ構造の理解

### Page_IDの意味
- **Page_ID**: アンケート用紙のページ番号（回答セット番号）
- 各Page_IDは**1人の回答者**による1枚のアンケート用紙を表す
- Page_ID=1は「1番目に処理されたアンケート用紙」を意味する

### 授業前後のデータの関係
- **授業前データ**: 99名の児童による授業前アンケート
- **授業後データ**: 99名の児童による授業後アンケート
- **重要**: 授業前のPage_ID=1と授業後のPage_ID=1は**別人の可能性が高い**
- **個人の追跡は不可能**: 匿名化により同一人物の前後比較はできない

## 分析上の前提条件と制約

### 1. 独立群として扱う必要性
```
✅ 正しい前提:
- 授業前群（n=99）と授業後群（n=99）は独立した2群
- 同じ母集団（同じ学校の児童）からの標本
- 群間比較のみ可能

❌ 誤った前提:
- 同一個人の前後比較
- ペアデータとしての分析
- 個人レベルの変化の追跡
```

### 2. 使用可能な統計手法
```
✅ 適切な手法:
- χ²検定（独立性の検定）
- Mann-Whitney U検定（独立2群の比較）
- Kruskal-Wallis検定（独立k群の比較）
- 独立サンプルのt検定（正規性が仮定できる場合）

❌ 不適切な手法:
- McNemar検定（対応のあるデータ用）
- 対応のあるt検定
- 反復測定分散分析
- 個人レベルの変化量分析
```

### 3. 解釈上の注意点

#### 因果推論の限界
- 観察された差異は「群間差」であり「変化」ではない
- 授業の効果と断定することはできない（交絡要因の可能性）
- あくまで「授業前群と授業後群の比較」として解釈

#### サンプルの代表性
- 両群が同じ母集団を代表していると仮定
- ランダムサンプリングではない可能性
- クラス構成の偏りが結果に影響する可能性

## 分析実施時のチェックリスト

### データ読み込み時
- [ ] Page_IDを個人識別子として使用していないか確認
- [ ] 授業前後のデータを独立した群として扱っているか確認
- [ ] ペアリング処理を行っていないか確認

### 統計検定実施時
- [ ] 独立群の検定手法を使用しているか確認
- [ ] 「変化」ではなく「差異」として記述しているか確認
- [ ] 効果量は群間差の効果量として計算しているか確認

### 結果解釈時
- [ ] 「個人の変化」ではなく「群間の差異」として解釈
- [ ] 因果関係ではなく相関関係として記述
- [ ] 限界事項を明記しているか確認

## コード実装時の注意

```python
# ❌ 誤った実装例
paired_data = pd.merge(before_df, after_df, on='Page_ID')  # これは誤り！

# ✅ 正しい実装例
# 独立した2群として扱う
before_group = before_df  # 授業前群（n=99）
after_group = after_df    # 授業後群（n=99）

# 群間比較の例
from scipy.stats import chi2_contingency, mannwhitneyu

# カテゴリカルデータの比較
crosstab = pd.crosstab(
    pd.concat([before_group['response'], after_group['response']]),
    pd.concat([['before']*len(before_group), ['after']*len(after_group)])
)
chi2, p_value, dof, expected = chi2_contingency(crosstab)
```

## 報告書記載時の表現

### ❌ 避けるべき表現
- "児童の理解度が向上した"
- "授業により知識が増加した"
- "個人レベルで変化が見られた"
- "授業前後で有意な改善"

### ✅ 適切な表現
- "授業後群は授業前群と比較して高い正答率を示した"
- "授業前群と授業後群の間に有意な差が認められた"
- "群間比較において差異が観察された"
- "授業後群の分布は授業前群と異なる傾向を示した"

## まとめ

**本データセットは個人の追跡ができない独立群データである。**
すべての分析はこの前提に基づいて実施し、結果の解釈も群間比較の観点から行う必要がある。
個人レベルの変化や授業効果の直接的な測定はできないことを常に念頭に置いて分析を進めること。

---
最終更新: 2025-05-31
作成者: Claude Code Analysis